<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="description" content="The intersection of code and photography">

        <meta property="og:title" content="Thoughts on what to return when you make a POST request? | Matthew Trask"/>
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://matthewtrask.net/blog/http-post-returns"/>
        <meta property="og:description" content="The intersection of code and photography" />

        <title>Matthew Trask | Thoughts on what to return when you make a POST request?</title>

        <link href="//cdn.rawgit.com/noelboss/featherlight/1.7.13/release/featherlight.min.css" type="text/css" rel="stylesheet" />
        <link rel="home" href="https://matthewtrask.net">
        <link rel="icon" href="/favicon.ico">
        <link href="/blog/feed.atom" type="application/atom+xml" rel="alternate" title="Matthew Trask Atom Feed">

            <meta property="og:title" content="Thoughts on what to return when you make a POST request?" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://matthewtrask.net/blog/http-post-returns"/>
    <meta property="og:description" content="Tons of stack overflow posts give varying advice so this is what I do when I make a POST Request in an application." />

                    <script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-64167405-1', 'auto');
              ga('send', 'pageview');

            </script>
        
        <link href="https://fonts.googleapis.com/css?family=Nunito+Sans:300,300i,400,400i,700,700i,800,800i" rel="stylesheet">
        <link rel="stylesheet" href="/assets/build/css/main.css?id=cdf0acba8d9fba91dfa2">
    </head>

    <body class="flex flex-col justify-between min-h-screen bg-grey-lightest text-grey-darkest leading-normal font-sans">
        <header class="flex items-center shadow bg-white border-b h-24 py-4" role="banner">
            <div class="container flex items-center max-w-4xl mx-auto px-4 lg:px-8">
                <div class="flex items-center">
                    <a href="/" title="Matthew Trask home" class="inline-flex items-center">
                        <img class="h-16 md:h-16 mr-3 rounded-full shadow-md" src="/assets/img/matthew-trask.png" alt="Matthew Trask logo" />

                        <h1 class="text-lg md:text-2xl text-teal-darker font-semibold hover:text-teal-dark my-0">Matthew Trask
                            <span class="block text-sm text-grey-darker font-semibold my-0">The intersection of code and photography</span>
                        </h1>
                    </a>
                </div>

                <div id="vue-search" class="flex flex-1 justify-end items-center">
                    <search></search>

                    <nav class="hidden lg:flex items-center justify-end text-lg">
    <a title="Matthew Trask Blog" href="/blog"
        class="ml-6 text-grey-darker hover:text-teal-dark ">
        Blog
    </a>

    <a title="Matthew Trask About" href="/about"
        class="ml-6 text-grey-darker hover:text-teal-dark ">
        About
    </a>
    
    <a title="Matthew Trask About" href="/photography"
        class="ml-6 text-grey-darker hover:text-teal-dark ">
        Photography
    </a>

    <a title="Matthew Trask Contact" href="/contact"
        class="ml-6 text-grey-darker hover:text-teal-dark ">
        Contact
    </a>
</nav>

                    <button class="flex justify-center items-center bg-blue border border-blue h-10 px-5 rounded-full lg:hidden focus:outline-none"
    onclick="navMenu.toggle()"
>
    <svg id="js-nav-menu-show" xmlns="http://www.w3.org/2000/svg"
        class="fill-current text-white h-9 w-4" viewBox="0 0 32 32"
    >
        <path d="M4,10h24c1.104,0,2-0.896,2-2s-0.896-2-2-2H4C2.896,6,2,6.896,2,8S2.896,10,4,10z M28,14H4c-1.104,0-2,0.896-2,2  s0.896,2,2,2h24c1.104,0,2-0.896,2-2S29.104,14,28,14z M28,22H4c-1.104,0-2,0.896-2,2s0.896,2,2,2h24c1.104,0,2-0.896,2-2  S29.104,22,28,22z"/>
    </svg>

    <svg id="js-nav-menu-hide" xmlns="http://www.w3.org/2000/svg"
        class="hidden fill-current text-white h-9 w-4" viewBox="0 0 36 30"
    >
        <polygon points="32.8,4.4 28.6,0.2 18,10.8 7.4,0.2 3.2,4.4 13.8,15 3.2,25.6 7.4,29.8 18,19.2 28.6,29.8 32.8,25.6 22.2,15 "/>
    </svg>
</button>

                </div>
            </div>
        </header>

        <nav id="js-nav-menu" class="nav-menu hidden lg:hidden">
    <ul class="list-reset my-0">
        <li class="pl-4">
            <a
                title="Matthew Trask Blog"
                href="/blog"
                class="nav-menu__item hover:text-blue "
            >Blog</a>
        </li>
        <li class="pl-4">
            <a
                title="Matthew Trask About"
                href="/about"
                class="nav-menu__item hover:text-blue "
            >About</a>
        </li>
        <li class="pl-4">
            <a
                title="Matthew Trask Contact"
                href="/contact"
                class="nav-menu__item hover:text-blue "
            >Contact</a>
        </li>
    </ul>
</nav>

        <main role="main" class="flex-auto w-full container max-w-xl mx-auto py-16 px-6">
                        <img src="/assets/img/indian-elephants.jpg" alt="Thoughts on what to return when you make a POST request? cover image" class="mb-2">
    
    <h1 class="leading-none mb-2">Thoughts on what to return when you make a POST request?</h1>

    <p class="text-grey-darker text-xl md:mt-0">Matt Trask  â€¢  April 26, 2020</p>
    <p class="text-grey-darker text-sm">Read Time: 3 mins</p>

                        <a
                href="/blog/categories/coding"
                title="View posts in coding"
                class="inline-block bg-grey-light hover:bg-teal-lighter leading-loose tracking-wide text-grey-darkest uppercase text-xs font-semibold rounded mr-4 px-3 pt-px"
            >coding</a>
                    <a
                href="/blog/categories/http"
                title="View posts in http"
                class="inline-block bg-grey-light hover:bg-teal-lighter leading-loose tracking-wide text-grey-darkest uppercase text-xs font-semibold rounded mr-4 px-3 pt-px"
            >http</a>
            
    <div class="border-b border-blue-lighter mb-10 pb-4" v-pre>
        <p>As one of the HTTP Verbs, a lot as been written around the POST action and what should be done. One thing that doesn't seem clear though is what should you return. The <a href="https://tools.ietf.org/html/rfc7231#page-25">RFC</a> from Dr. Fielding covers what they thought was ideal back in 2014 which is this:</p>
<blockquote>
<p>If one or more resources has been created on the origin server as a
result of successfully processing a POST request, the origin server
SHOULD send a 201 (Created) response containing a Location header
field that provides an identifier for the primary resource created
(Section 7.1.2) and a representation that describes the status of the
request while referring to the new resource(s)</p>
</blockquote>
<p>How would you do this? Something like this (example is Laravel but can easily have the classes changes for Symfony, Laminas or Zend): </p>
<pre><code>&lt;?php 

declare(strict_types=1);

use App\User;
use App\Services\UserService;
use Controller;
use Illuminate\Http\Response;

class UsersController extends Controller
{
    private Response $response;

    private UserServoce $serivce;

    public function __construct(Response $response)
    {
        $this-&gt;response = $response;
    }

    // ...

    public function create(CreateUserRequest $request) : Response
    {
        // pass data to a service to create a user
        $user = $this-&gt;service-&gt;createUser($user);

        return $this-&gt;response
            -&gt;withHeaders(['Location', sprintf('/api/users/%', $user-&gt;id)])
            -&gt;setStatusCode(201);
    }
}</code></pre>
<p>In the example, we get a user back from the CreateUserService class where in it we may have done things like set flags on the user for permissions and roles, sent emails alerting the user and others of their account, and maybe set a temp password for them to login. </p>
<p>The real question is what is the benefit of doing the above versus taking the user we get back, shoving it in to the response and moving on? Well, from my understanding, this is to take advantage of what REST aims for: discoverability. Why send the entire user back if there is potential we won't need it/want it? Instead we can tell the client &quot;Hey good news! The user was created. We are going to assume you don't need to do anything with it now, so if you look at the headers, you can find the location of the newly created resource. Otherwise, keep doing a great job!&quot;. While a user record <em>may</em> not be overly heavy, if you are creating multiple users for a system, think HR inviting users to a new benefits platform for instance, we can work faster if we dont need to keep returning the user record <em>every single time</em>. The last bit is the status code, which above is set to 201. 201 means &quot;Created&quot; which is the purpose of POST. We shouldn't POST to get data, edit data, or to delete data. </p>
<p>Conversely, there may be times that we want to return the data on top of the Location header. The RFC does say <code>should</code>, which is meant to be read as &quot;please do this, but its flexible and we won't get mad if you return the content created by the request&quot;. What would be an exmaple of a time you are wanting to return the content? Perhaps one example would be if you have multiple steps that depend on each other and you don't want to make a request every time. Think a shopping cart: you create the user if they dont exist and then we need to confirm their shipping and billing addresses. Now we create the user, and send back the address information so that way the user can quickly confirm it, which now streamlines the process slightly and eliminates a request. There absolutely are other use cases as well, so don't think the RFC is rigid, or we need to follow it 100% of the time. However it is good to try and follow the RFC/Standard as best as we can, to get the most of out REST.</p>
<p>Hopefully this gives you some ideas for writing your APIs going forward and guide you through some fun challenges!</p>    </div>

    <nav class="flex justify-between text-sm md:text-base">
        <div>
                            <a href="https://matthewtrask.net/blog/not-normal" title="Older Post: This isn&#039;t normal remote working life.">
                    &LeftArrow; This isn&#039;t normal remote working life.
                </a>
                    </div>

        <div>
                            <a href="https://matthewtrask.net/blog/mental-health-awareness" title="Newer Post: Mental Health Awareness Day">
                    Mental Health Awareness Day &RightArrow;
                </a>
                    </div>
    </nav>
        </main>

        <footer class="bg-white text-center text-sm mt-12 py-4" role="contentinfo">
            <ul class="flex flex-col md:flex-row justify-center list-reset">
                <li class="md:mr-2">
                    Written by <a href="https://twitter.com/matthewtrask">Matthew Trask</a> 2021.
                </li>

                <li>
                    Built with <a href="http://jigsaw.tighten.co" title="Jigsaw by Tighten">Jigsaw</a>
                    and <a href="https://tailwindcss.com" title="Tailwind CSS, a utility-first CSS framework">Tailwind CSS</a>.
                </li>
            </ul>
        </footer>

        <script src="/assets/build/js/main.js?id=7001cdcdf827737e6494"></script>

        <script>
    const navMenu = {
        toggle() {
            const menu = document.getElementById('js-nav-menu');
            menu.classList.toggle('hidden');
            menu.classList.toggle('lg:block');
            document.getElementById('js-nav-menu-hide').classList.toggle('hidden');
            document.getElementById('js-nav-menu-show').classList.toggle('hidden');
        },
    }
</script>
        <script src="//code.jquery.com/jquery-latest.js"></script>
        <script src="//cdn.rawgit.com/noelboss/featherlight/1.7.13/release/featherlight.min.js" type="text/javascript" charset="utf-8"></script>
    </body>
</html>
